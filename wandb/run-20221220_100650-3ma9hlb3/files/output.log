DDRNetSingle
{'depth': 1}
Dataset: Nyuv2 | Training Task: Depth | Primary Task: Depth in Multi-task / Auxiliary Learning Mode with DDRNET
Applying Multi-task Methods: Weighting-based: Equal + Gradient-based: NONE
STEP. Loading datasets...
Data sanity check. RGB.shape: torch.Size([32, 3, 288, 384]),	Depth.shape torch.Size([32, 1, 288, 384]),    	Semantic.shape torch.Size([32, 288, 384]),	Normals.shape torch.Size([32, 3, 288, 384])
  0%|                                                                                                                                                         | 0/25 [00:00<?, ?it/s]/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/functional.py:3635: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode)


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.55it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0000 | TRAIN: Depth 6.1769 6.1769 || TEST: Depth 1.9247 1.9247 | Best: Depth 1.9247
Task Weighting | Depth 1.0000
 24%|██████████████████████████████████▊                                                                                                              | 6/25 [00:01<00:04,  4.34it/s]
Saving full model


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.53it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0001 | TRAIN: Depth 3.9159 3.9159 || TEST: Depth 1.4961 1.4961 | Best: Depth 1.4961
Task Weighting | Depth 1.0000
Saving full model
 28%|████████████████████████████████████████▌                                                                                                        | 7/25 [00:01<00:04,  4.48it/s]


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.51it/s]
  0%|                                                                                                                                                         | 0/25 [00:00<?, ?it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0002 | TRAIN: Depth 1.9884 1.9884 || TEST: Depth 1.3199 1.3199 | Best: Depth 1.3199
Task Weighting | Depth 1.0000
Saving full model



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.48it/s]
  0%|                                                                                                                                                         | 0/25 [00:00<?, ?it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0003 | TRAIN: Depth 1.3497 1.3497 || TEST: Depth 1.0021 1.0021 | Best: Depth 1.0021
Task Weighting | Depth 1.0000
Saving full model



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.49it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0004 | TRAIN: Depth 1.2332 1.2332 || TEST: Depth 0.8822 0.8822 | Best: Depth 0.8822
Task Weighting | Depth 1.0000
Saving full model
0.8822329325887636 0.8822329325887636



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.17it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0005 | TRAIN: Depth 1.1752 1.1752 || TEST: Depth 0.8427 0.8427 | Best: Depth 0.8427
Task Weighting | Depth 1.0000
Saving full model
0.8427040191702321 0.8427040191702321



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.44it/s]
 16%|███████████████████████▏                                                                                                                         | 4/25 [00:01<00:06,  3.19it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0006 | TRAIN: Depth 1.0224 1.0224 || TEST: Depth 0.7590 0.7590 | Best: Depth 0.7590
Task Weighting | Depth 1.0000
Saving full model



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.07it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0007 | TRAIN: Depth 0.8954 0.8954 || TEST: Depth 0.8612 0.8612 | Best: Depth 0.7590
Task Weighting | Depth 1.0000
0.8612455012219457 0.7590159041780916


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.34it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0008 | TRAIN: Depth 0.8576 0.8576 || TEST: Depth 0.8078 0.8078 | Best: Depth 0.7590
Task Weighting | Depth 1.0000
0.8078226920793087 0.7590159041780916



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.41it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0009 | TRAIN: Depth 0.8433 0.8433 || TEST: Depth 0.8873 0.8873 | Best: Depth 0.7590
Task Weighting | Depth 1.0000
0.8872716444556054 0.7590159041780916



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0010 | TRAIN: Depth 0.7267 0.7267 || TEST: Depth 0.8901 0.8901 | Best: Depth 0.7590
Task Weighting | Depth 1.0000
0.8901460899000446 0.7590159041780916



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.51it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0011 | TRAIN: Depth 0.6551 0.6551 || TEST: Depth 0.7174 0.7174 | Best: Depth 0.7174
Task Weighting | Depth 1.0000
Saving full model
0.7173854524245878 0.7173854524245878



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.50it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0012 | TRAIN: Depth 0.6632 0.6632 || TEST: Depth 0.6721 0.6721 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
Saving full model
0.6721254409009316 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.41it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 0.0001
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0013 | TRAIN: Depth 0.7370 0.7370 || TEST: Depth 0.7594 0.7594 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7594315556763859 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1e-05
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0014 | TRAIN: Depth 0.6521 0.6521 || TEST: Depth 0.9309 0.9309 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.9308545166719714 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.46it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1e-05
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0015 | TRAIN: Depth 0.6341 0.6341 || TEST: Depth 0.7642 0.7642 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7641778473947892 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1e-05
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0016 | TRAIN: Depth 0.6415 0.6415 || TEST: Depth 0.8236 0.8236 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.823596947222819 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1e-05
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0017 | TRAIN: Depth 0.5547 0.5547 || TEST: Depth 0.7237 0.7237 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7237129823806496 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.46it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1e-05
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0018 | TRAIN: Depth 0.6321 0.6321 || TEST: Depth 0.7481 0.7481 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7480983281910111 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.01it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-06
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0019 | TRAIN: Depth 0.6601 0.6601 || TEST: Depth 0.7213 0.7213 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7213233830989375 0.6721254409009316


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.48it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-06
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0020 | TRAIN: Depth 0.6821 0.6821 || TEST: Depth 0.6898 0.6898 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.6898016927914776 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.25it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-06
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0021 | TRAIN: Depth 0.5272 0.5272 || TEST: Depth 0.7158 0.7158 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.7158045121088102 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.11it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-06
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0022 | TRAIN: Depth 0.5739 0.5739 || TEST: Depth 0.6924 0.6924 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.692417831752869 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.33it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-06
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0023 | TRAIN: Depth 0.6440 0.6440 || TEST: Depth 0.6818 0.6818 | Best: Depth 0.6721
Task Weighting | Depth 1.0000
0.6817659816383462 0.6721254409009316



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.33it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0024 | TRAIN: Depth 0.5865 0.5865 || TEST: Depth 0.6667 0.6667 | Best: Depth 0.6667
Task Weighting | Depth 1.0000
Saving full model
0.6667046473265182 0.6667046473265182



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.45it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0025 | TRAIN: Depth 0.5525 0.5525 || TEST: Depth 0.6810 0.6810 | Best: Depth 0.6667
Task Weighting | Depth 1.0000
0.6810446883190633 0.6667046473265182



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.37it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0026 | TRAIN: Depth 0.5838 0.5838 || TEST: Depth 0.7154 0.7154 | Best: Depth 0.6667
Task Weighting | Depth 1.0000
0.7154404159362194 0.6667046473265182


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
 24%|██████████████████████████████████▊                                                                                                              | 6/25 [00:01<00:04,  4.26it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0027 | TRAIN: Depth 0.6081 0.6081 || TEST: Depth 0.7241 0.7241 | Best: Depth 0.6667
Task Weighting | Depth 1.0000


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.43it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0028 | TRAIN: Depth 0.6626 0.6626 || TEST: Depth 0.7168 0.7168 | Best: Depth 0.6667
Task Weighting | Depth 1.0000
0.7168096307515772 0.6667046473265182



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.28it/s]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0001
    lr: 1.0000000000000002e-07
    weight_decay: 0
)
Entering evaluation phase...
Epoch 0029 | TRAIN: Depth 0.5865 0.5865 || TEST: Depth 0.7035 0.7035 | Best: Depth 0.6667
Task Weighting | Depth 1.0000
0.7035166641088194 0.6667046473265182
Training complete