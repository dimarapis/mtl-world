DDRNetSingle
{'depth': 1}
Dataset: Nyuv2 | Training Task: Depth | Primary Task: Depth in Multi-task / Auxiliary Learning Mode with DDRNET
Applying Multi-task Methods: Weighting-based: Equal + Gradient-based: NONE
STEP. Loading datasets...
Data sanity check. RGB.shape: torch.Size([32, 3, 288, 384]),	Depth.shape torch.Size([32, 1, 288, 384]),    	Semantic.shape torch.Size([32, 288, 384]),	Normals.shape torch.Size([32, 3, 288, 384])
  0%|                                                                                                                                                                                                | 0/25 [00:00<?, ?it/s]/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/functional.py:3635: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode)

 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 20/25 [00:04<00:00,  5.11it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.63it/s]
Entering evaluation phase...
Epoch 0000 | TRAIN: Depth 6.1772 6.1772 || TEST: Depth 1.8302 1.8302 | Best: Depth 1.8302
Task Weighting | Depth 1.0000
Saving full model
1.8301704013694158 1.8301704013694158


 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 23/25 [00:05<00:00,  4.90it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.45it/s]
Entering evaluation phase...
Epoch 0001 | TRAIN: Depth 3.9524 3.9524 || TEST: Depth 1.6248 1.6248 | Best: Depth 1.6248
Task Weighting | Depth 1.0000
Saving full model
1.6247656682758185 1.6247656682758185

 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                  | 16/25 [00:03<00:01,  5.05it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.54it/s]
Entering evaluation phase...
Epoch 0002 | TRAIN: Depth 2.0029 2.0029 || TEST: Depth 1.5798 1.5798 | Best: Depth 1.5798
Task Weighting | Depth 1.0000
Saving full model
1.5797923693603122 1.5797923693603122


 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 22/25 [00:04<00:00,  5.03it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.56it/s]
Entering evaluation phase...
Epoch 0003 | TRAIN: Depth 1.3157 1.3157 || TEST: Depth 1.3025 1.3025 | Best: Depth 1.3025
Task Weighting | Depth 1.0000
Saving full model
1.3025443707737931 1.3025443707737931

 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                  | 16/25 [00:03<00:01,  4.91it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.55it/s]
Entering evaluation phase...
Epoch 0004 | TRAIN: Depth 1.2392 1.2392 || TEST: Depth 1.0821 1.0821 | Best: Depth 1.0821
Task Weighting | Depth 1.0000
Saving full model
1.082146810377402 1.082146810377402


 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 20/25 [00:04<00:00,  5.04it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.61it/s]
Traceback (most recent call last):
  File "train_model.py", line 364, in <module>
    for multitaskdatatest in test_loader:
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dim/mdpi_robotics/mtl-world/autolambda_code.py", line 118, in __getitem__
    normal = torch.from_numpy(np.moveaxis(np.load(self.data_path + '/normals_npy/{:d}.npy'.format(index)), -1, 0)).float()
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/numpy/lib/npyio.py", line 441, in load
    pickle_kwargs=pickle_kwargs)
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/numpy/lib/format.py", line 753, in read_array
    array = numpy.fromfile(fp, dtype=dtype, count=count)
KeyboardInterrupt